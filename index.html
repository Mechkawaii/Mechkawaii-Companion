<!doctype html>
<html lang="fr">
<head>
  <link rel="stylesheet" href="./style.css" />
  <link rel="icon" type="image/png" href="./assets/heart.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mechkawaii ‚Äî Fiches</title>
  <script>
    // Prevent splash "flash" on reload: apply the state *before* CSS paints
    (function(){
      try{
        if (localStorage.getItem('mechkawaii:splashDismissed') === '1') {
          document.documentElement.classList.add('splash-dismissed');
        }
      } catch (e) {}
    })();
  </script>
  <link rel="stylesheet" href="./style.css" />
</head>

<body class="page-index has-splash">
  <div class="container">
    <div class="topbar">
      <div class="brand">
        <div class="title">MECHKAWAII COMPANION</div>
        <div class="subtitle" data-i18n="index_subtitle">Choisis ton mode et ton camp.</div>
      </div>

      <!-- ‚úÖ Plus de langue ici : le choix se fait sur l'√©cran "Jouer" -->
      <div class="controls">
        <!-- (Optionnel) On garde le select cach√© au cas o√π : app.js peut aussi le masquer -->
        <div class="pill" style="display:none;">
          <span class="small">Lang</span>
          <select id="lang" aria-label="Language" disabled>
            <option value="fr">FR</option>
            <option value="en">EN</option>
          </select>
        </div>
      </div>
    </div>

    <div id="setupCard" class="card" style="margin-top:16px; display:none;">
      <div class="card-h">
        <div class="section-title" data-i18n="setup_title" style="margin:0;">Configuration de la partie</div>
      </div>
      <div class="card-b">
        <div class="rule" style="margin-top:0;">
          <h3 data-i18n="setup_q_devices">1) Combien d'appareil ?</h3>
          <p class="text" data-i18n="setup_q_devices_desc">
            Si un seul appareil sert √† tout le monde, tu verras tous les persos. Sinon, chaque joueur choisit son camp.
          </p>
          <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
            <button id="modeSingle" class="btn-accent" data-i18n="setup_mode_single">Un seul appareil pour la table</button>
            <button id="modeMulti" data-i18n="setup_mode_multi">Chaque joueur √† son appareil</button>
          </div>
        </div>

        <div id="campPick" class="rule" style="display:none;">
          <h3 data-i18n="setup_q_camp">2) Choisis ton camp</h3>
          <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
            <button id="campMech" class="btn-accent" data-i18n="camp_mech">Mechkawaii</button>
            <button id="campProd" data-i18n="camp_prod">Prodrome</button>
          </div>
          <div class="footer-note" data-i18n="setup_change_later">
            Tu pourras changer plus tard via ‚ÄúChanger Mode‚Äù.
          </div>
        </div>

        <div id="difficultyPick" class="rule" style="display:none;">
          <h3 data-i18n="setup_q_difficulty">3) Choisis la difficult√©</h3>

          <!-- ‚úÖ FIX doublon : UN SEUL <p>, et il contient bien tout le texte -->
          <p class="text"
   data-i18n="setup_difficulty_desc"
   data-i18n-html="1">
</p>


          <div style="margin-top:10px; display:flex; gap:10px; flex-wrap:wrap;">
            <button id="diffNormal" class="btn-accent" data-i18n="diff_normal">‚≠ê Normal</button>
            <button id="diffExpert" data-i18n="diff_expert">üíÄ Expert</button>
          </div>
        </div>

        <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
          <button id="resetSetupBtn" class="btn-danger" data-i18n="reset_all">Tout r√©initialiser</button>
        </div>
      </div>
    </div>

    <div id="draftCard" class="card" style="margin-top:16px; display:none;">
      <div class="card-h">
        <div class="section-title" data-i18n="draft_title" style="margin:0;">S√©lection des unit√©s</div>
        <div class="small" data-i18n="draft_subtitle">Choisis les unit√©s jou√©s</div>
      </div>
      <div class="card-b">
        <p class="text" data-i18n="draft_desc" style="margin-top:0;">
          S√©lectionne uniquement les unit√©s r√©ellement jou√©es. Les autres ne s‚Äôafficheront pas.
        </p>
        <div id="draftList" class="toggles" style="margin-top:12px;"></div>
        <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
          <button id="confirmDraft" class="btn-accent" data-i18n="draft_confirm">Valider les X unit√©s</button>
          <button id="skipDraft" data-i18n="draft_show_all">Afficher tout (pour l‚Äôinstant)</button>
        </div>
        <div id="draftError" class="footer-note" style="color: var(--danger);"></div>
      </div>
    </div>

    <div class="controls" style="margin-top:16px; display:flex; justify-content:flex-end;">
      <button id="backToSplash" data-i18n="back_to_title">√âcran titre</button>
      <button id="changeSetupBtn" data-i18n="change_mode">Changer mode</button>
      <button id="changeDraftBtn" data-i18n="change_units">Changer unit√©s</button>
    </div>

    <div id="splash" class="splash splash-overlay">
      <div class="hero">
        <img src="./assets/cover.png" alt="Mechkawaii cover" class="hero-bg" />
        <div class="overlay"></div>

        <div class="hero-ui">
          <!-- ‚úÖ Langue sur le splash -->
          <div class="splash-lang" id="splashLang" aria-label="Language">
            <button class="flag-btn" type="button" data-lang="fr" aria-label="Fran√ßais" title="Fran√ßais">üá´üá∑</button>
            <button class="flag-btn" type="button" data-lang="en" aria-label="English" title="English">üá¨üáß</button>
          </div>

          <div class="brand-stack">
            <img src="./assets/heart.png" alt="" class="mascot" />
            <img src="./assets/logo.png" alt="Mechkawaii Companion" class="logo" />
          </div>

          <div class="menu">
            <button id="playBtn" class="mkw-btn">
              <img src="./assets/ui/btn_play.svg" alt="" aria-hidden="true">
              <span class="mkw-label" data-i18n="splash_play">JOUER</span>
            </button>

            <a class="mkw-link" href="https://mechkawaii.com" target="_blank" rel="noopener">
              <div class="mkw-btn">
                <img src="./assets/ui/btn_play.svg" alt="" aria-hidden="true">
                <span class="mkw-label" data-i18n="splash_site">SITE</span>
              </div>
            </a>

            <a class="mkw-link" href="https://instagram.com/mechkawaii" target="_blank" rel="noopener">
              <div class="mkw-btn">
                <img src="./assets/ui/btn_play.svg" alt="" aria-hidden="true">
                <span class="mkw-label" data-i18n="splash_instagram">INSTAGRAM</span>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="charList" class="list" aria-live="polite"></div>
  <div id="error" class="footer-note" style="color: var(--danger);"></div>

  <!-- BARRE DE TABS DES UNIT√âS (fix√©e en bas) -->
  <div class="unit-tabs-container" id="unitTabsContainer">
    <div class="unit-tabs" id="unitTabs"></div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
